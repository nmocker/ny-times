{"version":3,"sources":["main.js"],"names":["Main","dateString","matched","match","year","length","Date","getFullYear","testDate","parseInt","nuull","mm","dd","formattedDate","event","preventDefault","queryEl","document","querySelector","startDateEl","endDateEl","queryTerm","value","startDateOrig","startDate","reformatDate","endDateOrig","endDate","selectOptionsEl","selectOptionsOrig","searchOptions","begin_date","end_date","sort","api","NytApi","search","setupEventListeners","buttonEl","addEventListener","handleSearch","bodyEl","handleResults","handleSearchError","results","resultsUl","result","detail","resultLi","createElement","appendChild","imgEl","img","multimedia","setAttribute","url","articles","articleInfo","sectionEl","textContent","section_name","linkEl","titleEl","web_url","headline","main","abstractEl","snippet","bylineInfoDiv","bylineDiv","bylineEl","r","byline","original","dateEl","pub_date","slice","toDateString","error"],"mappings":"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","sourcesContent":["class Main {\n  constructor() {\n    // what's the flow here?\n    // 1. setup form events listener(s) that will make the actual api calls\n    // 2. setup callback functions to process api responses\n    this.setupEventListeners();\n  }\n\n  setupEventListeners() {\n    const buttonEl = document.querySelector('[name=\"search\"]');\n    buttonEl.addEventListener(\"click\", this.handleSearch);\n\n    const bodyEl = document.querySelector(\"body\");\n    bodyEl.addEventListener(\"got-results\", this.handleResults);\n    bodyEl.addEventListener(\"got-error\", this.handleSearchError);\n  }\n\n  reformatDate = (dateString) => {\n    if (dateString == null || dateString == \"\") {\n      return null;\n    }\n\n    const matched = dateString.match(\n      /^(0?[1-9]|1[0-2])\\W(3[01]|[12][0-9]|0?[1-9])\\W?(\\d*?)$/\n    );\n\n    let year = matched[3];\n    if (year.length == 0) {\n      year = new Date().getFullYear();\n    } else if (year.length == 2) {\n      year = `20${year}`;\n    } else if (year.length != 4) {\n      return null;\n    }\n\n    const testDate = new Date(year, parseInt(matched[1]) - 1, matched[2]);\n    if (testDate == nuull) {\n      return null;\n    }\n\n    let mm = matched[1];\n    if (mm.length == 1) {\n      mm = `0${mm}`;\n    }\n    let dd = matched[2];\n    if (dd.length == 1) {\n      dd = `0${dd}`;\n    }\n\n    let formattedDate = `${year}${mm}${dd}`;\n\n    return formattedDate;\n  };\n\n  handleSearch = (event) => {\n    event.preventDefault();\n\n    const queryEl = document.querySelector('[name=\"query\"]');\n    const startDateEl = document.querySelector('[name=\"startDate\"]');\n    const endDateEl = document.querySelector('[name=\"endDate\"]');\n    const queryTerm = queryEl.value;\n    const startDateOrig = startDateEl.value;\n    const startDate = this.reformatDate(startDateOrig);\n    const endDateOrig = endDateEl.value;\n    const endDate = this.reformatDate(endDateOrig);\n\n    const selectOptionsEl = document.querySelector('[name=\"sort\"]');\n    const selectOptionsOrig = selectOptionsEl.value;\n\n    const searchOptions = {};\n    if (startDate != null) {\n      searchOptions.begin_date = startDate;\n    }\n    if (endDate != null) {\n      searchOptions.end_date = endDate;\n    }\n    searchOptions.sort = selectOptionsOrig;\n\n    const api = new NytApi();\n    api.search(queryTerm, searchOptions);\n  };\n\n  handleResults(results) {\n    const resultsUl = document.querySelector(\".results\");\n\n    for (let result in results.detail) {\n      const resultLi = document.createElement(\"li\");\n      resultsUl.appendChild(resultLi);\n\n      const imgEl = document.createElement(\"img\");\n      resultLi.appendChild(imgEl);\n      for (let img in results.detail[result].multimedia) {\n        imgEl.setAttribute(\n          \"src\",\n          \"https://www.nytimes.com\" + results.detail[result].multimedia[img].url\n        );\n      }\n\n      const articles = document.createElement(\"div\");\n      articles.setAttribute(\"class\", \"articles-div\");\n      resultLi.appendChild(articles);\n\n      const articleInfo = document.createElement(\"div\");\n      articleInfo.setAttribute(\"class\", \"article-info\");\n      articles.appendChild(articleInfo);\n\n      const sectionEl = document.querySelector(\"span\");\n      articleInfo.appendChild(sectionEl);\n      sectionEl.textContent = results.detail[result].section_name;\n\n      const linkEl = document.createElement(\"a\");\n      articleInfo.appendChild(linkEl);\n      const titleEl = document.createElement(\"h2\");\n      linkEl.appendChild(titleEl);\n      linkEl.setAttribute(\"href\", results.detail[result].web_url);\n      linkEl.setAttribute(\"target\", \"_blank\");\n      titleEl.textContent = results.detail[result].headline.main;\n\n      const abstractEl = document.createElement(\"p\");\n      articleInfo.appendChild(abstractEl);\n      abstractEl.textContent = results.detail[result].snippet;\n\n      const bylineInfoDiv = document.querySelector(\"div\");\n      bylineInfoDiv.setAttribute(\"class\", \"byline-info\");\n      articles.appendChild(bylineDiv);\n\n      const bylineEl = document.createElement(\"span\");\n      bylineInfoDiv.appendChild(bylineEl);\n      if (results.detail[r].byline.original === null) {\n        bylineEl.textContent === \"Staff\";\n      } else {\n        bylineEl.textContent = results.detail[result].byline.original + \" \";\n      }\n\n      const dateEl = document.createElement(\"span\");\n      bylineInfoDiv.appendChild(dateEl);\n      new Date(results.detail[result].pub_date.slice(0, 19));\n      dateEl.textContent = new Date(\n        results.detail[result].pub_date\n      ).toDateString();\n    }\n  }\n\n  handleSearchError(error) {}\n}\n\nnew Main();\n"],"file":"main.js"}