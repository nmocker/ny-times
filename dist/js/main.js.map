{"version":3,"sources":["main.js"],"names":["Main","dateString","matched","match","year","length","Date","getFullYear","testDate","parseInt","mm","dd","formattedDate","event","preventDefault","queryEl","document","querySelector","startDateEl","endDateEl","queryTerm","value","startDateOrig","startDate","reformatDate","endDateOrig","endDate","selectOptionsEl","selectOptionsOrig","searchOptions","begin_date","end_date","sort","api","NytApi","search","setupEventListeners","buttonEl","addEventListener","handleSearch","bodyEl","handleResults","handleSearchError","resultsUl","innerHTML","results","detail","textContent","result","article","resultLi","createElement","appendChild","articles","setAttribute","articleInfo","imgEl","classList","add","multimedia","style","backgroundImage","url","sectionEl","section_name","linkEl","titleEl","web_url","headline","main","abstractEl","snippet","bylineInfoDiv","bylineEl","byline","original","dateEl","pub_date","slice","toDateString","error"],"mappings":"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","sourcesContent":["class Main {\n  constructor() {\n    // what's the flow here?\n    // 1. setup form events listener(s) that will make the actual api calls\n    // 2. setup callback functions to process api responses\n    this.setupEventListeners();\n  }\n\n  setupEventListeners() {\n    const buttonEl = document.querySelector('[name=\"search\"]');\n    buttonEl.addEventListener(\"click\", this.handleSearch);\n\n    const bodyEl = document.querySelector(\"body\");\n    bodyEl.addEventListener(\"got-results\", this.handleResults);\n    bodyEl.addEventListener(\"got-error\", this.handleSearchError);\n  }\n\n  reformatDate = (dateString) => {\n    if (dateString == null || dateString == \"\") {\n      return null;\n    }\n\n    const matched = dateString.match(\n      /^(0?[1-9]|1[0-2])\\W(3[01]|[12][0-9]|0?[1-9])\\W?(\\d*?)$/\n    );\n\n    let year = matched[3];\n    if (year.length == 0) {\n      year = new Date().getFullYear();\n    } else if (year.length == 2) {\n      year = `20${year}`;\n    } else if (year.length != 4) {\n      return null;\n    }\n\n    const testDate = new Date(year, parseInt(matched[1]) - 1, matched[2]);\n    if (testDate == null) {\n      return null;\n    }\n\n    let mm = matched[1];\n    if (mm.length == 1) {\n      mm = `0${mm}`;\n    }\n    let dd = matched[2];\n    if (dd.length == 1) {\n      dd = `0${dd}`;\n    }\n\n    let formattedDate = `${year}${mm}${dd}`;\n\n    return formattedDate;\n  };\n\n  handleSearch = (event) => {\n    event.preventDefault();\n\n    const queryEl = document.querySelector('[name=\"query\"]');\n    const startDateEl = document.querySelector('[name=\"startDate\"]');\n    const endDateEl = document.querySelector('[name=\"endDate\"]');\n    const queryTerm = queryEl.value;\n    const startDateOrig = startDateEl.value;\n    const startDate = this.reformatDate(startDateOrig);\n    const endDateOrig = endDateEl.value;\n    const endDate = this.reformatDate(endDateOrig);\n\n    const selectOptionsEl = document.querySelector('[name=\"sort\"]');\n    const selectOptionsOrig = selectOptionsEl.value;\n\n    const searchOptions = {};\n    if (startDate != null) {\n      searchOptions.begin_date = startDate;\n    }\n    if (endDate != null) {\n      searchOptions.end_date = endDate;\n    }\n    searchOptions.sort = selectOptionsOrig;\n\n    const api = new NytApi();\n    api.search(queryTerm, searchOptions);\n  };\n\n  handleResults(event) {\n    const resultsUl = document.querySelector(\".results\");\n    resultsUl.innerHTML = \"\"\n\n    const results = event.detail;\n\n    if (!results || results.length === 0) {\n      results.textContent = \"Womp womp...\";\n      return;\n    }\n\n    for (let result in results) {\n      const article = results[result];\n      const resultLi = document.createElement(\"li\");\n      resultsUl.appendChild(resultLi);\n\n      \n\n      const articles = document.createElement(\"div\");\n      articles.setAttribute(\"class\", \"articles-div\");\n      resultLi.appendChild(articles);\n\n      const articleInfo = document.createElement(\"div\");\n      articleInfo.setAttribute(\"class\", \"article-info\");\n      articles.appendChild(articleInfo);\n\n      const imgEl = document.createElement(\"div\");\n      imgEl.classList.add(\"photo\");\n      resultLi.appendChild(imgEl)\n      if (article.multimedia.length > 0) {\n        imgEl.style.backgroundImage = `url(https://www.nytimes.com/${article.multimedia[0].url})`;\n      }\n\n      const sectionEl = document.createElement(\"span\");\n      articleInfo.appendChild(sectionEl);\n      sectionEl.textContent = article.section_name;\n\n      const linkEl = document.createElement(\"a\");\n      articleInfo.appendChild(linkEl);\n      const titleEl = document.createElement(\"h2\");\n      linkEl.appendChild(titleEl);\n      linkEl.setAttribute(\"href\", article.web_url);\n      linkEl.setAttribute(\"target\", \"_blank\");\n      titleEl.textContent = article.headline.main;\n\n      const abstractEl = document.createElement(\"p\");\n      articleInfo.appendChild(abstractEl);\n      abstractEl.textContent = article.snippet;\n\n      const bylineInfoDiv = document.createElement(\"div\");\n      bylineInfoDiv.setAttribute(\"class\", \"byline-info\");\n      articleInfo.appendChild(bylineInfoDiv);\n\n      const bylineEl = document.createElement(\"span\");\n      bylineInfoDiv.appendChild(bylineEl);\n      if (article.byline.original === null) {\n        bylineEl.textContent === \"Staff\";\n      } else {\n        bylineEl.textContent = article.byline.original + \" \";\n      }\n\n      const dateEl = document.createElement(\"span\");\n      bylineInfoDiv.appendChild(dateEl);\n      dateEl.classList.add(\"date\");\n      new Date(article.pub_date.slice(0, 19));\n      dateEl.textContent = new Date(article.pub_date).toDateString();\n    }\n  }\n\n  handleSearchError(error) {}\n}\n\nnew Main();\n"],"file":"main.js"}